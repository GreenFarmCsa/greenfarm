(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["me.taskDetail"],{1:function(t,e){},"18dd":function(t,e){t.exports="data:image/png;base64,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"},2:function(t,e){},"2d99":function(t,e,i){t.exports=i.p+"static/img/grapes-1.e2a72a8b.png"},3:function(t,e){},4:function(t,e){},"47c5":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r}));var s=i("b775");function a(t){return Object(s["a"])({url:"/live/add",method:"post",data:t})}function o(t){return Object(s["a"])({url:"/live/queryByFarmId",method:"get",params:t})}function r(t){return Object(s["a"])({url:"/live/revise",method:"post",data:t})}},5538:function(t,e,i){"use strict";i("8a24")},"8a24":function(t,e,i){},"8f27":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"taskDetail"},[s("div",{staticClass:"hint"}),s("div",{staticClass:"box"},[s("div",{staticClass:"box-top"},[s("div",{staticClass:"boxtitle"},[t._v(t._s(t.plantStep)+" Method")])]),s("div",{staticClass:"boxcontent"},[s("p",[t._v(t._s(t.plantTaskDetail&&t.plantTaskDetail.remark?t.plantTaskDetail.remark:""))])])]),s("div",{staticClass:"box"},[s("div",{staticClass:"box-top"},[s("div",{staticClass:"boxtitle"},[t._v("Records Of "+t._s(t.plantStep))]),s("div",{class:t.but},["but-2"==t.but?s("button",{staticClass:"btn",on:{click:t.approved}},[t._v("Submit")]):s("button",{staticClass:"btn"},[t._v("Submit")])])]),t.ifapproved?s("div",{staticClass:"approved"},[s("div",{staticClass:"dian"}),s("span",[t._v("Approved")])]):s("div",{staticClass:"unapproved"},[s("div",{staticClass:"dian"}),s("span",[t._v("Unapproved")])]),s("div",{staticClass:"boxcontent"},[s("div",{staticClass:"left"},[t.plantTaskDetail&&t.plantTaskDetail.operRecord?s("div",{staticStyle:{float:"left"}},[t._l(t.imgRecordList,(function(e,i){return s("div",{key:i,staticClass:"fileload"},[s("img",{attrs:{src:t.imgurl(e.url)},on:{click:function(e){return t.viewImg(i,"1")}}})])})),t._l(t.videoRcordList,(function(e,i){return s("div",{key:i,staticClass:"fileload"},[s("div",{staticClass:"videoIcon",on:{click:function(i){t.videoPlay(t.videourl(e.url.split(",")[1]),"normal")}}},[s("svg-icon",{staticStyle:{"font-size":"0.4rem"},attrs:{iconClass:"begin"}})],1),s("img",{attrs:{src:e.url&&e.url.split(",").length>0?t.imgurl(e.url.split(",")[0]):""},on:{click:function(i){t.videoPlay(t.videourl(e.url.split(",")[1]),"normal")}}})])}))],2):t._e(),t._l(t.videoList,(function(e){return s("div",{key:e,staticClass:"fileload",on:{click:function(i){t.videoPlay(t.videourl(e.video),"normal")}}},[s("div",{staticClass:"videoIcon"},[s("svg-icon",{staticStyle:{"font-size":"0.4rem"},attrs:{iconClass:"begin"}})],1),s("img",{attrs:{src:t.imgurl(e.pic)}})])})),t._l(t.picList,(function(e){return s("div",{key:e,staticClass:"fileload"},[s("img",{attrs:{src:t.imgurl(e)},on:{click:function(e){return t.viewImg(t.index,"2")}}})])})),t.uploadLoading?s("div",{staticClass:"fileload",staticStyle:{display:"flex","align-items":"center","justify-content":"center",width:"1.4rem",height:"1.4rem"}},[s("van-loading")],1):t._e(),t.showAddImg&&!t.uploadLoading?s("div",{staticClass:"fileload",on:{click:function(e){return t.upload()}}},[s("svg-icon",{staticStyle:{"font-size":"1.4rem"},attrs:{iconClass:"camera-blue-add"}})],1):t._e()],2)])]),s("div",{staticClass:"box"},[s("div",{staticClass:"box-top"},[s("div",{staticClass:"boxtitle"},[t._v("Live")]),s("div",{staticClass:"video-start-center",on:{click:function(e){return t.startLive()}}},[t._m(0),s("span",[t._v("Start")])])]),s("div",{staticClass:"boxcontent"},[t.liveRecordList&&t.liveRecordList.length>0?s("div",{staticClass:"live-record-container"},[t._l(t.liveRecordList,(function(e,a){return s("div",{key:a,staticClass:"record-item",on:{click:function(i){t.videoPlay(t.videourl(e),"normal")}}},[s("img",{attrs:{src:i("d6ff"),alt:""}})])})),t._l(5,(function(t){return s("div",{key:t+"a",staticClass:"record-item"})}))],2):s("div",{staticClass:"live-record-kong"},[s("img",{attrs:{src:i("18dd"),alt:""}}),s("div",{staticClass:"tip"},[t._v("There is no recording yet")])])])]),s("div",{staticClass:"box"},[t._m(1),s("div",{staticClass:"boxcontent"},[s("div",{staticClass:"left"},t._l(t.plantTaskDetail.videoUrl,(function(e,i){return s("div",{key:i,staticClass:"fileload",on:{click:function(i){t.videoPlay(e.split(",")[0],"youtube")}}},[s("div",{staticClass:"videoIcon"},[s("svg-icon",{staticStyle:{"font-size":"0.4rem"},attrs:{iconClass:"begin"}})],1),s("img",{attrs:{src:t.imgurl(e.split(",")[1]),alt:""}})])})),0)])]),t.videoPopupShow?s("div",{staticStyle:{position:"fixed","z-index":"2000",top:"0",left:"0",right:"0",bottom:"0",background:"#000"}},[s("div",{staticStyle:{width:"100%",background:"#fff",padding:"0.4rem 0.16rem","font-size":"0.4rem"},on:{click:function(e){t.videoPopupShow=!1}}},[s("van-icon",{staticStyle:{"padding-left":"0.06rem"},attrs:{name:"arrow-left",color:"#333333",size:"0.4rem"}})],1),s("div",{staticStyle:{height:"calc(100% - 1.3rem)",position:"relative",display:"flex","align-items":"center"},attrs:{id:"videoContainer"}},["normal"==t.videoType?s("video",{staticStyle:{width:"100vw",height:"100%","background-color":"#000"},attrs:{src:t.videoUrl,controls:"controls",autoplay:""}}):s("iframe",{staticStyle:{width:"100vw"},attrs:{src:t.videoUrl,title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})])]):t._e()])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"img"},[s("img",{attrs:{src:i("d77f"),alt:""}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box-top"},[i("div",{staticClass:"boxtitle"},[t._v("Planting Tutorial")])])}],o=i("28a2"),r=i("c155"),l=i("47c5"),n=(i("1503"),{components:{[o["a"].Component.name]:o["a"].Component},data(){return{ifapproved:!1,showAddImg:!0,but:"but",hidding:"right",toVideos:"fileload",toPhotos:"fileload",plantStep:"",picList:[],videoList:[],videoPopupShow:!1,videoUrl:"",videoType:"normal",plantTaskDetail:[],taskRevise:{},liveRecordList:[],imgRecordList:[],videoRcordList:[],uploadLoading:!1}},mounted(){this.querytaskdetail()},watch:{videoPopupShow(t,e){if(t){let t=document.body.scrollTop||document.documentElement.scrollTop;document.body.style.cssText+="position:fixed;width:100%;top:-"+t+"px;"}else{let t=document.body;t.style.position="";let e=t.style.top;document.body.scrollTop=document.documentElement.scrollTop=-parseInt(e),t.style.top=""}}},methods:{videoPlay(t,e){this.videoType=e,this.videoUrl=t,this.videoPopupShow=!0},viewImg(t,e){let s=[];if("1"==e&&this.plantTaskDetail&&this.plantTaskDetail.operRecord){let t=JSON.parse(this.plantTaskDetail.operRecord);t.forEach(t=>{"image"==t.type&&s.push("http://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8081/file/download?url="+t.url)})}else"2"==e?this.picList.forEach(t=>{s.push("http://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8081/file/download?url="+t)}):"3"==e&&s.push(i("2d99"));Object(o["a"])({images:s,startPosition:t})},taskrevise(){let t=[];this.plantTaskDetail.operRecord&&this.plantTaskDetail.operRecord.length>0&&(t=JSON.parse(this.plantTaskDetail.operRecord)),this.picList.forEach(e=>{t.push({type:"image",url:e})}),this.videoList.forEach(e=>{t.push({type:"video",url:e.pic+","+e.video})}),Object(r["c"])({operRecord:t,stepId:this.$route.query.stepId}).then(t=>{this.but="but",this.showAddImg=!1,this.$toast({message:"success",position:"bottom"}),this.$router.back()}).catch(t=>{console.log(t)})},querytaskdetail(){2==this.$route.query.status&&(this.showAddImg=!1),this.plantStep=this.$route.query.plantStep,Object(r["b"])({id:this.$route.query.stepId}).then(t=>{this.plantTaskDetail=t.data,this.plantTaskDetail&&this.plantTaskDetail.operRecord&&(this.ifapproved=!0,JSON.parse(this.plantTaskDetail.operRecord).forEach(t=>{"live"==t.type?this.liveRecordList.push(t.url):"image"==t.type?this.imgRecordList.push(t):"video"==t.type&&this.videoRecordList.push(t)}))}).catch(t=>{console.log(t)})},approved(){2!=this.$route.query.status&&this.taskrevise()},imgurl(t){return"http://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8081/file/download?url="+t},videourl(t){return"http://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8081/file/play?url="+t},upload(){this.uploadLoading=!0;let t=2;window.UMJSBridge.callHandler("jumpCamera",{type:0,maxSelectable:9,mimeType:t,maxRecordTime:30,capture:!0},(function(t){})),window.UMJSBridge.registerHandler("jumpCamera",t=>{this.uploadLoading=!1,t&&("video"==t[0].type?t[0].success?(this.videoList.push({video:t[0].uFileId,pic:t[1].uFileId}),this.but="but-2",this.ifapproved=!0):this.$toast({message:"upload failed",position:"bottom"}):"picture"==t[0].type?t.forEach(t=>{t.success&&(this.picList.push(t.uFileId),this.but="but-2",this.ifapproved=!0)}):this.$toast({message:"upload failed",position:"bottom"}))})},startLive(){Object(l["a"])({farmId:this.$route.query.farmId,status:"1",stepId:this.$route.query.stepId,username:this.$store.state.user.username}).then(t=>{t.data&&t.data.liveId?window.UMJSBridge.callHandler("liveAPI",{index:"0",url:"rtmp://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8090/zbs/"+t.data.liveId},e=>{"live close"==e?(this.$toast({message:"live exit~",position:"bottom"}),Object(l["c"])({farmId:this.$route.query.farmId,liveId:t.data.liveId,status:"0",username:this.$store.state.user.username}).then(t=>{}).catch(t=>{})):this.$toast({message:"start live failed!",position:"bottom"})}):this.$toast({message:"start live failed!",position:"bottom"})}).catch(t=>{console.log("error",t)})}},destroyed(){}}),c=n,d=(i("5538"),i("2877")),u=Object(d["a"])(c,s,a,!1,null,"74de7519",null);e["default"]=u.exports},c155:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r}));var s=i("b775");function a(t){return Object(s["a"])({url:"/plant-task/querySteps",method:"get",params:t})}function o(t){return Object(s["a"])({url:"/plant-task/queryTaskDetail",method:"get",params:t})}function r(t){return Object(s["a"])({url:"/plant-task/revise",method:"put",data:t})}},d6ff:function(t,e,i){t.exports=i.p+"static/img/live-record.76faba29.png"},d77f:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAmCAYAAAC/H3lnAAAAAXNSR0IArs4c6QAAAyhJREFUWAnNmLtu1EAUhtdclijcFgkooIm4BGmRINxBAfIACImKloYXoaHlJaBFihAUSBQkAhSUICCigECB0kSigAKWS4Dl+xdP5HjHnlnvrOMj/Tqei898Ho+Px45qgazdbjcINYEOok1oCb1Gs1EUtfFBLAoRBdg9xLmGhizx3lN3B+i/lraeq9b5ngHUMBqJZ3LlNMrrKVxFNlj1O4DGdRDCNvgEAeoY/S4jwdUov8PdZda+4/ejHSjPTtI4ndfBt805w8DtI9gV1IGNA4/iL8XHu2Of5xrEyboDeed1tTmBOaPZddb/iiYQukM/MtqT1csUfiUrih77AOuJt5nO1ax/QK4ssFjmQ6en3GaC+Ik+0zhj6xDX/cY/yGnvqclnhpVLn6eifqE8mah7yPEzlJ5p9bvNRX1K9O3r0DsPxw+f8q0gFjS76ZHp06BOWcO8OHQXtH6D2Qowg20hatZ6DTZgRqCvtgmw9Y3iWVHi32vrUFKdltI8mgRcaz7TtIb1QlhLWMHpTh9B51TIMwGP5HUouc3JImCv13NJ4Btd4/ikNVeMUturNLvWCycp6G16GB1CbyoLDOgwgNrlnUZbkWy0H2DtIRbRUeTaXtLFzwDdRc+zaAyl+erKwzf8Qq3q9YfSTeXM+JYp+ATavqpX7wXF1RLItPQVZHZMNSybBI/XIHOAv8KfQBeR3ppFLBdWAYsCd8HEFzAD+Asate7OI63DoBYM2FABrs3OE8Bn8WfQOArytUGc2sDyMODaK08xxi30UoOFsIEBGzig9Qn12JT79cGXRBqIpbGTOvPBmm7uuTwwYECVm5XqlPK0GwtiwYEBVS5WajuOgi+5YMCAKvdeQKeQM5/Sp5AVBa4DOKQHCq9cq5yr3OvcHhaiTJxUFFi3+jqwS3jtouqJmAM9LAosKG1SpJCm3wEfkTZU1rvVD3BIUBOrxTK7x517RIX2JVpm20yjfNWAO2xAtziYBvwpvon0caoP5YVKAgPWMcC1E9Tn/zzwm/EtPTxB/ioSJ4R1/U0yQYH/htoCfmsqK+CdLFoS95H+vCg9rdmvKsbWdnQO5do/7j7HUzPyxEoAAAAASUVORK5CYII="}}]);