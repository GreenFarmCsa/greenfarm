(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["me.communityPosts"],{"08a3":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"picker"},[a("van-field",{attrs:{readonly:"",clickable:"",value:t.showValue,"right-icon":"arrow-down"},on:{click:function(e){t.showPicker=!0}}}),a("van-popup",{staticClass:"popupPicker",attrs:{round:"",position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:t.columns,"value-key":t.valueKey,"cancel-button-text":"cancel","confirm-button-text":"confirm"},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm}})],1)],1)},n=[],i={name:"PopupPicker",props:{columns:{type:Array,default:()=>[]},valueKey:{type:String,default:""},realValueKey:{type:String,default:""},showValueKey:{type:String,default:""},backVal:{type:String,default:"value"}},data(){return{showPicker:!1,showValue:"",realValue:""}},methods:{onConfirm(t,e){this.showValue=t[this.showValueKey],this.showPicker=!1,"value"==this.backVal?this.$emit("onConfirm",t[this.realValueKey]):"index"==this.backVal&&this.$emit("onConfirm",{value:t,index:e})}},watch:{},mounted(){}},r=i,s=(a("9cb0"),a("2877")),c=Object(s["a"])(r,o,n,!1,null,"993e1b3e",null);e["a"]=c.exports},"0fac":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i})),a.d(e,"f",(function(){return r})),a.d(e,"d",(function(){return s})),a.d(e,"e",(function(){return c})),a.d(e,"c",(function(){return l})),a.d(e,"g",(function(){return m}));var o=a("b775");function n(t){return Object(o["a"])({url:"/topic/add",method:"post",data:t})}function i(t){return Object(o["a"])({url:"/topic/addComment",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/topic/queryComment",method:"get",params:t})}function s(t){return Object(o["a"])({url:"/topic/queryByCommunityId",method:"get",params:t})}function c(t){return Object(o["a"])({url:"/topic/queryByUserName",method:"get",params:t})}function l(t){return Object(o["a"])({url:"/topic/queryByTopicId",method:"get",params:t})}function m(t){return Object(o["a"])({url:"/topic/like",method:"put",params:t})}},"1f84":function(t,e,a){"use strict";a("9119")},"1fa4":function(t,e,a){"use strict";a("9779")},"3d55":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"farmaddbody"},[a("div",{staticClass:"split"}),a("div",{staticClass:"body"},[a("div",{staticClass:"body-content"},[t._m(0),a("div",{staticClass:"form-body"},[a("div",{staticClass:"farmLogo"},[a("Label",{attrs:{title:t.farmName.farmName,must:t.farmName.must}}),a("div",{staticClass:"location"},[a("PopupPicker",{attrs:{columns:t.farmList,valueKey:"farmName",realValueKey:"communityId",showValueKey:"communityName",backVal:"value"},on:{onConfirm:function(e){return t.onConfirm(e)}}})],1)],1),a("div",{staticClass:"farmLogo"},[a("Label",{attrs:{title:t.topicName.farmName,must:t.topicName.must}}),a("div",{staticClass:"farmCrops"},[a("FormInput",{staticClass:"formInput",attrs:{error:t.topicName.error,placeholder:t.topicName.placeholder,inputval:t.formData.topicName},model:{value:t.formData.topicName,callback:function(e){t.$set(t.formData,"topicName",e)},expression:"formData.topicName"}})],1)],1),a("div",{staticClass:"farmLogo"},[a("Label",{attrs:{title:t.topicContent.farmName,must:t.topicContent.must}}),a("div",{staticClass:"farmLogos"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.topicContent,expression:"formData.topicContent"}],attrs:{name:"",id:"",rows:"5",placeholder:t.topicContent.placeholder},domProps:{value:t.formData.topicContent},on:{blur:t.onblur,input:function(e){e.target.composing||t.$set(t.formData,"topicContent",e.target.value)}}}),a("div",{class:t.errors},[t._v(t._s(t.topicContent.error))])])],1),a("div",{staticClass:"farmLogo"},[a("Label",{attrs:{title:t.topicLogo.farmName,must:t.topicLogo.must}}),t.uploadLoading?a("div",{staticClass:"logo"},[a("van-loading")],1):a("div",{staticClass:"logo"},[a("div",{class:t.imglogoclass,on:{click:t.uploadimg}},[a("svg-icon",{staticStyle:{"font-size":"1.4rem"},attrs:{iconClass:"camera-blue-add"}})],1),a("div",{class:t.imglogohid,on:{click:t.uploadimg}},[a("img",{attrs:{src:t.getImg(t.formData.topicImageUrl),alt:""}})]),a("div",{class:t.imgclass})])],1),a("div",{staticClass:"bottom-button"},[a("div",{staticClass:"confirm",on:{click:function(e){return t.confirm()}}},[a("button",{class:[t.confirmOK?"ok":""]},[t._v("Post")])])])])])])])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-title"},[a("span")])}],i=a("08a3"),r=a("4af8"),s=a("8641"),c=(a("d415"),a("0fac")),l=a("7998"),m=a("d399"),u={components:{FormInput:r["a"],Label:s["a"],PopupPicker:i["a"]},data(){return{showPicker:!1,imgclass:"logo-right",imglogoclass:"logo-left",imglogohid:"hidden",showCommunityId:"",formData:{communityId:"",topicName:"",topicContent:"",topicImageUrl:""},farmName:{farmName:"Please select a farm",error:"Name of the farm is not allowed null",placeholder:"Please select the…",must:"must"},topicName:{farmName:"Title",error:"Title of the community is not allowed null",placeholder:"Leave a title here…",must:"must"},topicLogo:{farmName:"Select a picture",error:"picture of the community is not allowed null",placeholder:"The image size is limited to 800K.",must:"must"},topicContent:{farmName:"Content",error:"Content of the community is not allowed null",placeholder:"Leave a content here…",must:"must"},farmList:[],errors:"hidden",uploadLoading:!1}},mounted(){this.getData()},computed:{confirmOK(){return""!==this.formData.farmId&&""!==this.formData.topicImageUrl&&""!==this.formData.topicName&&""!==this.formData.topicContent}},methods:{onConfirm(t){this.formData.communityId=t},getData(){let t={name:this.$store.state.user.username||"jack"};Object(l["b"])(t).then(t=>{this.farmList=t.data})},confirm(){if(!this.confirmOK)return;let t={username:this.$store.state.user.username||"fred",communityId:this.formData.communityId,topicName:this.formData.topicName,topicContent:this.formData.topicContent,topicImageUrl:this.formData.topicImageUrl};Object(c["a"])(t).then(t=>{t.data&&t.data.topicId&&(this.$router.replace({path:"/community/post-detail/"+t.data.topicId}),Object(m["a"])({message:"success",icon:"passed"}))}).catch(t=>{console.log(error,t)})},getImg(t){return"http://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8081/file/download?url="+t},uploadimg(){this.upload(),this.formData.topicImageUrl&&(this.imgclass="hidden",this.imglogoclass="hidden",this.imglogohid="imgs")},upload(){this.uploadLoading=!0,window.UMJSBridge.callHandler("jumpCamera",{type:0,maxSelectable:1,mimeType:0,maxRecordTime:30,capture:!0},(function(t){})),window.UMJSBridge.registerHandler("jumpCamera",t=>{this.uploadLoading=!1,t&&t[0].success&&"picture"==t[0].type&&(this.formData.topicImageUrl=t[0].uFileId,this.formData=Object.assign({},this.formData),this.formData.topicImageUrl&&(this.imgclass="hidden",this.imglogoclass="hidden",this.imglogohid="imgs"))})},onblur(){this.formData.topicContent?this.errors="hidden":this.errors="error"}}},d=u,p=(a("893f"),a("2877")),f=Object(p["a"])(d,o,n,!1,null,"9ea08262",null);e["default"]=f.exports},"4af8":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[a("div",{staticClass:"input"},[t.disabled?a("input",{class:t.input,attrs:{readonly:"",type:"text",placeholder:t.placeholder,maxlength:"30"},domProps:{value:t.value},on:{blur:t.onblur,input:function(e){return t.$emit("input",e.target.value)}}}):a("input",{class:t.input,attrs:{type:"text",placeholder:t.placeholder,maxlength:"30"},domProps:{value:t.value},on:{blur:t.onblur,input:function(e){return t.$emit("input",e.target.value)}}}),a("div",{class:t.errors},[t._v(t._s(t.error))])])])},n=[],i={name:"FormInput",props:{title:{type:String,default:""},error:{type:String,default:""},placeholder:{type:String,default:""},inputval:{type:String,default:""},disabled:{type:Boolean,default:!1},value:{type:String,default:""}},data(){return{input:"inputstyle",errors:"hidden",val:this.inputval}},methods:{onblur(){this.error&&!this.inputval?this.errors="error":this.errors="hidden"}},watch:{newValue(){this.$emit("input",this.val)}},mounted(){}},r=i,s=(a("eb6b1"),a("2877")),c=Object(s["a"])(r,o,n,!1,null,"3fafde89",null);e["a"]=c.exports},5015:function(t,e,a){},"5c4d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"homepage"},[a("div",{staticClass:"user-message-wrapper"},[a("div",{staticClass:"user-img"},[a("img",{attrs:{src:t.dataObj.iconUrl,alt:""}})]),a("div",{staticClass:"user-message"},[a("div",{staticClass:"user-name"},[t._v(t._s(t.dataObj.username))]),a("div",{staticClass:"user-time"},[t._v(t._s(t.dataObj.createTime))])])]),a("div",{staticClass:"img-wrapper"},[a("img",{attrs:{src:t.dataObj.topicImageUrl,alt:""}})]),a("div",{staticClass:"like-wrapper"},[t.dataObj.hasLiked?a("svg-icon",{staticStyle:{"font-size":"0.38rem","vertical-align":"middle"},attrs:{iconClass:"heart-enabled"},on:{click:function(e){return e.stopPropagation(),t.onLike(t.dataObj)}}}):a("svg-icon",{staticStyle:{"font-size":"0.38rem","vertical-align":"middle"},attrs:{iconClass:"heart-disabled"},on:{click:function(e){return e.stopPropagation(),t.onLike(t.dataObj)}}}),a("div",{staticClass:"like-num",on:{click:function(e){return e.stopPropagation(),t.onLike(t.dataObj)}}},[t._v(t._s(t.dataObj.likeSum))])],1),a("div",{staticClass:"comments-wrapper"},[a("div",{staticClass:"title"},[t._v(t._s(t.dataObj.topicName))]),a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.dataObj.topicContent)}}),a("div",{staticClass:"total"},[t._v(t._s(t.commentsList.length)+" comments in total")]),a("div",{staticClass:"comments-list"},t._l(t.commentsList,(function(e){return a("div",{key:e.commentId,staticClass:"comments-list-item"},[a("div",{staticClass:"name"},[t._v(t._s(e.username))]),a("div",{staticClass:"content",domProps:{innerHTML:t._s(e.commentContent)}})])})),0)]),a("div",{staticClass:"input-wrapper"},[a("van-cell-group",[a("van-field",{attrs:{placeholder:"Leave a comment here…",disabled:t.inputShow},on:{click:t.inputFocuse},model:{value:t.newComments,callback:function(e){t.newComments=e},expression:"newComments"}})],1)],1),a("van-action-sheet",{model:{value:t.inputShow,callback:function(e){t.inputShow=e},expression:"inputShow"}},[a("div",{staticClass:"action-sheet-wrapper"},[a("div",{staticClass:"action-sheet-input-wrapper"},[a("van-cell-group",[a("van-field",{ref:"comment",attrs:{placeholder:"Leave a comment here…"},model:{value:t.newCommentsSheet,callback:function(e){t.newCommentsSheet=e},expression:"newCommentsSheet"}})],1)],1),a("van-button",{attrs:{type:"primary"},on:{click:t.addTopicComment}},[a("svg-icon",{staticStyle:{"font-size":"0.38rem"},attrs:{iconClass:"send-comment"}})],1)],1)])],1)},n=[],i=a("0fac"),r=a("ed08"),s={name:"HomePage",data(){return{dataObj:{},commentsList:[],newComments:"",newCommentsSheet:"",inputShow:!1}},computed:{},mounted(){this.getData()},methods:{getData(){let t={topicId:this.$route.params.id,username:this.$store.state.user.username};Object(i["c"])(t).then(t=>{let e=t.data;e.topicContent&&(e.topicContent=e.topicContent.replace(/\n/g,"<br/>")),this.dataObj=e,this.dataObj.createTime=Object(r["b"])(this.dataObj.createTime),this.dataObj.topicImageUrl="http://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8081/file/download?url="+this.dataObj.topicImageUrl,this.dataObj.iconUrl="http://ec2-52-80-243-127.cn-north-1.compute.amazonaws.com.cn:8081/file/download?url="+this.dataObj.iconUrl,this.$set(this.dataObj,"flag",!0)}),this.getTopicComment()},getTopicComment(){let t={topicId:this.$route.params.id};Object(i["f"])(t).then(t=>{let e=t.data;for(let a=0,o=e.length;a<o;a++)e[a].commentContent&&(e[a].commentContent=e[a].commentContent.replace(/\n/g,"<br/>"));this.commentsList=e})},inputFocuse(){this.inputShow=!0,this.$nextTick(()=>{this.$refs.comment.focus()})},addTopicComment(){let t={commentContent:this.newCommentsSheet,username:this.$store.state.user.username||"jack",topicId:this.$route.params.id};Object(i["b"])(t).then(t=>{this.getTopicComment(),this.inputShow=!1,this.newCommentsSheet=""}).catch(t=>{console.log(t)})},onLike(t){let e={topicId:t.topicId,username:this.$store.state.user.username||"jack",isLike:!t.hasLiked};Object(i["g"])(e).then(t=>{this.getData()}).catch(t=>{console.log(t)})}}},c=s,l=(a("f0c1"),a("1fa4"),a("2877")),m=Object(l["a"])(c,o,n,!1,null,"1c7d4673",null);e["default"]=m.exports},7998:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var o=a("b775");function n(t){return Object(o["a"])({url:"/community/queryByFarmId",method:"get",params:t})}function i(t){return Object(o["a"])({url:"/community/queryByUserName",method:"get",params:t})}},8641:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[a("div",{staticClass:"label"},[a("span",{class:t.must},[t._v("*")]),a("span",{staticClass:"title"},[t._v(t._s(t.title))])])])},n=[],i={name:"FormInput",props:{title:{type:String,default:""},must:{type:String,default:""}},data(){return{}},methods:{},created(){},mounted(){}},r=i,s=(a("1f84"),a("2877")),c=Object(s["a"])(r,o,n,!1,null,"24a03c7b",null);e["a"]=c.exports},"893f":function(t,e,a){"use strict";a("d76a")},9119:function(t,e,a){},9779:function(t,e,a){},"9cb0":function(t,e,a){"use strict";a("d363")},a677:function(t,e,a){},d363:function(t,e,a){},d415:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"b",(function(){return r})),a.d(e,"e",(function(){return s})),a.d(e,"d",(function(){return c})),a.d(e,"f",(function(){return l})),a.d(e,"h",(function(){return m})),a.d(e,"g",(function(){return u})),a.d(e,"k",(function(){return d})),a.d(e,"i",(function(){return p})),a.d(e,"j",(function(){return f}));var o=a("b775");function n(t){return Object(o["a"])({url:"/farm/add",method:"post",data:t})}function i(t){return Object(o["a"])({url:"/farm/query",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/farm/queryAll",method:"get",params:t})}function s(t){return Object(o["a"])({url:"/farm/queryByLocation",method:"get",params:t})}function c(t){return Object(o["a"])({url:"/farm/queryById",method:"get",params:t})}function l(t){return Object(o["a"])({url:"/farm/queryByProductName",method:"get",params:t})}function m(t){return Object(o["a"])({url:"/farm/queryByUserName",method:"get",params:t})}function u(t){return Object(o["a"])({url:"/farm/queryByTotalArea",method:"get",params:t})}function d(t){return Object(o["a"])({url:"/farm/revise",method:"put",data:t})}function p(t){return Object(o["a"])({url:"/seed/query",method:"get",params:t})}function f(t){return Object(o["a"])({url:"/seed/queryById",method:"get",params:t})}},d76a:function(t,e,a){},eb6b1:function(t,e,a){"use strict";a("5015")},f0c1:function(t,e,a){"use strict";a("a677")}}]);